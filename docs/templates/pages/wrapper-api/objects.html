<div class="x-page-content text">

<h1 class="ui dividing header">Сущности Wrapper API</h1>

<p>Описание основных сущностей, которые используются <b>Wrapper API</b> и принципы, как они связаны с сущностями <b>Wialon API</b>.</p>

<h2 id="auth_token" class="ui header">Авторизационный токен</h2>

<p>В <b>Wialon</b> для совершения запросов требуется <b>sid</b>, который можно получить либо из <b>authHash</b>, либо из <b>токена</b>.

<p><b>authHash</b> является одноразовым, выдаётся формой логина.</p>

<p><b>Токен</b> создаётся на какое-то время, долго живёт, является многоразовым, может содержать какие-то произвольные данные (например, настройки отображения <a href="https://docs.wialon.com/en/hosting/user/monitor/locator">Локатора</a>).</p>

<p>Для обеспечения forward compatibility, мы вводим понятие <b>Wrapper Token</b>, представляющий собой строку, которая идентифицирует одну сессию использования <b>API</b>.</p>

<p>Мы не используем просто <b>sid</b> потому, что, возможно, данное <b>API</b> сможет оборачивать не только <b>Wialon API</b>, но и какое-нибудь другое со схожими сущностями.</p>

<p>Получить этот токен можно используя методы <b>/auth/wialon/sid</b>, <b>/auth/wialon/hash</b>, <b>/auth/wialon/token</b> <span style="color:red;">(TODO)</span>.</p>

<h2 class="ui header">Item</h2>

<p>Абсолютно любая сущность (но не её поля) <b>Wrapper API</b> называется <b>Item'ом</b>.</p>

<p>Каждый <b>Item</b> имеет уникальный строковый идентификатор, однозначно идентифицируя соответствующую сущность <b>Wialon</b>.</p>

<p>Идентификация сущностей <b>Wialon</b>:</p>

<ul class="x-ul">
	<li>Идентификатор <b>Wialon Item</b> остаётся тем же, что и был.</li>
	<li>
		<p><b>PropItems'ы</b> получают префикс:</p>
		<p><ul class="x-ul">
			<li><b>cf</b> — произвольные поля</li>
			<li><b>cp</b> — произвольные параметры</li>
			<li><b>g</b> — геозоны</li>
			<li><b>n</b> — уведомления</li>
			<li><b>j</b> — задания</li>
			<li><b>r</b> — отчёты</li>
			<li><b>d</b> — водители</li>
			<li><b>t</b> — трейлеры</li>
			<li><b>p</b> — пассажиры</li>
			<li>остальные будут добавлены по мере поддержки</li>
		</ul></p>
		<p>Затем следует <b>id Item'а</b> и через знак подчёркивания <b>id PropItem'а</b>. Например, водитель с <b>id 7</b> в <b>ресурсе 3</b> получает идентификатор <b>d3_7</b>.</p>
	</li>
</ul>

</div>